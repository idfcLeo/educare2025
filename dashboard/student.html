<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Student Dashboard - Educare</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@400;500;600;700&display=swap" rel="stylesheet">
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css">
    <link rel="stylesheet" href="../assets/css/style.css">
</head>
<body class="bg-gray-100 text-gray-800">

    <div class="flex min-h-screen">
        <!-- Sidebar Placeholder -->
        <div id="sidebar-placeholder"></div>

        <main class="flex-1 p-8">
            <header class="flex justify-between items-center mb-8">
                <h1 class="text-2xl font-bold text-gray-700">Student Dashboard</h1>
                <div class="font-semibold text-gray-600">School Year 2024 - 2025</div>
            </header>

            <div class="grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-4 gap-6 mb-8">
                <div class="dashboard-card flex items-center gap-4">
                    <div class="bg-red-100 p-3 rounded-full"><i class="fas fa-school text-red-500 text-xl"></i></div>
                    <div>
                        <p class="text-gray-500">Schools</p>
                        <p class="text-2xl font-bold">69</p>
                    </div>
                </div>
                <div class="dashboard-card flex items-center gap-4">
                     <div class="bg-blue-100 p-3 rounded-full"><i class="fas fa-chalkboard-teacher text-blue-500 text-xl"></i></div>
                    <div>
                        <p class="text-gray-500">Teachers</p>
                        <p class="text-2xl font-bold">88</p>
                    </div>
                </div>
                <div class="dashboard-card flex items-center gap-4">
                     <div class="bg-yellow-100 p-3 rounded-full"><i class="fas fa-user-graduate text-yellow-500 text-xl"></i></div>
                    <div>
                        <p class="text-gray-500">Students</p>
                        <p class="text-2xl font-bold">90</p>
                    </div>
                </div>
                <div class="dashboard-card flex items-center gap-4">
                     <div class="bg-green-100 p-3 rounded-full"><i class="fas fa-user-friends text-green-500 text-xl"></i></div>
                    <div>
                        <p class="text-gray-500">Parents</p>
                        <p class="text-2xl font-bold">128</p>
                    </div>
                </div>
            </div>

            <div class="grid grid-cols-1 lg:grid-cols-3 gap-8">
                <div class="lg:col-span-2 space-y-8">
                    <div class="dashboard-card p-8 bg-purple-100/50 flex items-center justify-between rounded-xl">
                        <div>
                            <h1 class="text-3xl font-bold text-gray-800">Welcome back, Alex!</h1>
                            <p class="text-gray-600 mt-2">You've achieved 80% of your weekly goals. Keep it up!</p>
                        </div>
                    </div>
                    
                    <div class="dashboard-card p-6">
                        <h2 class="text-xl font-bold mb-4">Grade Trends</h2>
                        <div class="relative h-72 w-full">
                            <canvas id="gradesChart"></canvas>
                        </div>
                    </div>

                    <div class="grid grid-cols-1 md:grid-cols-2 gap-8">
                        <div class="dashboard-card p-6 text-center">
                            <h2 class="text-xl font-bold mb-4">My Academic Health</h2>
                            <div class="dial-container">
                                <div class="dial-background"></div>
                                <div class="dial-mask"></div>
                                <div id="student-dial-needle" class="dial-needle" style="transform: translateX(-50%) rotate(-45deg);"></div>
                                <div class="dial-center"></div>
                            </div>
                            <p id="student-risk-text" class="text-lg font-bold text-green-600 mt-4">Low Risk</p>
                        </div>
                        <div class="dashboard-card p-6 flex flex-col items-center justify-center text-center">
                            <h2 class="text-xl font-bold mb-2">Psychometric Assessment</h2>
                            <p class="text-gray-600 mb-4">Understand your unique strengths and challenges.</p>
                            <button onclick="navigateTo('psychometric-test.html')" class="w-full bg-indigo-600 text-white font-bold py-2 px-4 rounded-lg hover:bg-indigo-700 transition">Take the Test</button>
                        </div>
                    </div>
                </div>

                <div class="space-y-8">
                    <div class="dashboard-card p-6 text-center flex flex-col items-center">
                        <img src="https://www.formula1points.com/images/driver/max-verstappen.webp" alt="Alex Johnson" class="w-20 h-20 rounded-full mb-3 border-2 border-indigo-200">
                        <h2 class="text-xl font-bold">Alex Johnson</h2>
                        <p class="text-gray-500">Student</p>
                         <button onclick="logout()" class="mt-4 w-full text-indigo-600 font-semibold py-2 rounded-lg hover:bg-indigo-50 transition">Logout</button>
                    </div>
                    
                    <div class="dashboard-card p-6">
                        <h2 class="text-xl font-bold mb-4">My Weekly Goals</h2>
                        <div id="goals-list" class="space-y-3"></div>
                        <div class="mt-4">
                            <input id="new-goal-input" type="text" class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-indigo-500" placeholder="Add a new goal...">
                            <button onclick="addGoal()" class="w-full mt-2 bg-indigo-800 text-white font-bold py-2 px-4 rounded-lg hover:bg-indigo-900 transition">Add Goal</button>
                        </div>
                    </div>

                    <div class="dashboard-card p-6">
                        <h2 class="text-xl font-bold mb-4">My Achievements</h2>
                        <div id="achievements-list" class="flex justify-around items-center">
                            <div class="text-center">
                                <i class="fas fa-trophy text-yellow-500 text-3xl mb-1"></i>
                                <p class="text-sm">Top Performer</p>
                            </div>
                            <div class="text-center">
                                <i class="fas fa-award text-blue-500 text-3xl mb-1"></i>
                                <p class="text-sm">Effort Award</p>
                            </div>
                            <div class="text-center">
                                <i class="fas fa-star text-green-500 text-3xl mb-1"></i>
                                <p class="text-sm">Great Attendance</p>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </main>
    </div>
    
    <!-- Shared and Sidebar Scripts -->
    <script src="../assets/js/include.js"></script>
    <script src="../assets/js/student.js"></script>

    <!-- Page-specific scripts -->
    <script>
        document.addEventListener('DOMContentLoaded', () => {
            // --- Grade Trends Chart ---
            const gradesCtx = document.getElementById('gradesChart').getContext('2d');
            const gradesChart = new Chart(gradesCtx, {
                type: 'line',
                data: {
                    labels: ['Jan', 'Feb', 'Mar', 'Apr', 'May', 'Jun', 'Jul', 'Aug'],
                    datasets: [{
                        label: 'Math Grades',
                        data: [85, 88, 90, 82, 95, 92, 98, 90],
                        borderColor: '#4f46e5',
                        backgroundColor: 'rgba(79, 70, 229, 0.1)',
                        fill: true,
                        tension: 0.4,
                    }, {
                        label: 'Science Grades',
                        data: [78, 85, 80, 87, 83, 90, 88, 94],
                        borderColor: '#22c55e',
                        backgroundColor: 'rgba(34, 197, 94, 0.1)',
                        fill: true,
                        tension: 0.4,
                    }]
                },
                options: {
                    responsive: true, maintainAspectRatio: false,
                    plugins: { legend: { position: 'top' }},
                    scales: { y: { beginAtZero: false }}
                }
            });

            // Initial render for goals and health
            renderGoals();
            updateAcademicHealth(70); // Example initial value
        });

        // --- Academic Health Dial Logic ---
        function updateAcademicHealth(score) {
            const needle = document.getElementById('student-dial-needle');
            const riskText = document.getElementById('student-risk-text');
            const rotation = -45 + (Math.max(0, Math.min(100, score)) / 100) * 180;
            needle.style.transform = `translateX(-50%) rotate(${rotation}deg)`;
            
            let riskLevel = "Low Risk", textColor = "text-green-600";
            if (score < 40) { riskLevel = "High Risk"; textColor = "text-red-600"; }
            else if (score < 70) { riskLevel = "Moderate Risk"; textColor = "text-yellow-600"; }
            riskText.textContent = riskLevel;
            riskText.className = `text-lg font-bold mt-4 ${textColor}`;
        }

        // --- Weekly Goals Logic ---
        let goals = [
            { text: 'Complete Math Homework', completed: false },
            { text: 'Read 30 minutes', completed: true },
            { text: 'Review Science notes', completed: false }
        ];

        function renderGoals() {
            const goalsList = document.getElementById('goals-list');
            goalsList.innerHTML = '';
            goals.forEach((goal, index) => {
                const div = document.createElement('div');
                div.className = 'flex items-center space-x-2';
                div.innerHTML = `
                    <input type="checkbox" id="goal-${index}" class="form-checkbox h-5 w-5 text-indigo-600 rounded" ${goal.completed ? 'checked' : ''} onchange="toggleGoal(${index})">
                    <label for="goal-${index}" class="text-gray-700 ${goal.completed ? 'line-through text-gray-400' : ''}">${goal.text}</label>
                `;
                goalsList.appendChild(div);
            });
        }

        function addGoal() {
            const input = document.getElementById('new-goal-input');
            if (input.value.trim()) {
                goals.push({ text: input.value.trim(), completed: false });
                input.value = '';
                renderGoals();
            }
        }

        function toggleGoal(index) {
            goals[index].completed = !goals[index].completed;
            renderGoals();
        }
    </script>
</body>
</html>

